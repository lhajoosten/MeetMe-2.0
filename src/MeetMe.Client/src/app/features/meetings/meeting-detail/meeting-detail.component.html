<div class="meeting-detail-container" *ngIf="meeting; else loadingTemplate">
  <!-- Header -->
  <div class="meeting-header">
    <button class="btn-back" routerLink="/meetings">
      <app-icon name="arrow-left" [size]="16"></app-icon> Back to Meetings
    </button>

    <div class="meeting-status-badge" [class.public]="meeting.isPublic">
      {{ meeting.isPublic ? 'Public' : 'Private' }}
    </div>

    <h1>{{ meeting.title }}</h1>
    <p class="meeting-description">{{ meeting.description }}</p>

    <div class="meeting-meta">
      <div class="meta-row">
        <div class="meta-item">
          <app-icon name="calendar" [size]="20"></app-icon>
          <div>
            <strong>{{ formatDate(meeting.startDateTime) }}</strong>
            <span>{{ formatTime(meeting.startDateTime) }} - {{ formatTime(meeting.endDateTime) }}</span>
          </div>
        </div>
        <div class="meta-item">
          <app-icon name="location" [size]="20"></app-icon>
          <div>
            <strong>{{ meeting.location }}</strong>
          </div>
        </div>
      </div>
      <div class="meta-row">
        <div class="meta-item">
          <app-icon name="user" [size]="20"></app-icon>
          <div>
            <strong>Organized by</strong>
            <span>{{ meeting.organizer?.firstName || 'Unknown' }} {{ meeting.organizer?.lastName || '' }}</span>
          </div>
        </div>
        <div class="meta-item">
          <app-icon name="users" [size]="20"></app-icon>
          <div>
            <strong>{{ meeting.attendees?.length || 0 }} attendees</strong>
            <span *ngIf="meeting.maxAttendees">
              ({{ meeting.maxAttendees - (meeting.attendees?.length || 0) }} spots left)
            </span>
          </div>
        </div>
      </div>
    </div>

    <div class="action-buttons" *ngIf="!isOrganizer">
      <button
        class="btn btn-primary"
        *ngIf="!userAttendance"
        (click)="joinMeeting()"
        [disabled]="isLoading"
      >
        {{ isLoading ? 'Joining...' : 'Join Meeting' }}
      </button>

      <div class="attendance-status" *ngIf="userAttendance">
        <span class="status-badge" [class]="userAttendance.status.toLowerCase()">
          {{ userAttendance.status }}
        </span>
        <button
          class="btn btn-outline"
          (click)="leaveMeeting()"
          [disabled]="isLoading"
        >
          Leave Meeting
        </button>
      </div>
    </div>

    <div class="organizer-actions" *ngIf="isOrganizer">
      <button class="btn btn-secondary" (click)="editMeeting()">
        Edit Meeting
      </button>
      <button class="btn btn-danger" (click)="deleteMeeting()">
        Delete Meeting
      </button>
    </div>
  </div>

  <!-- Attendees Section -->
  <div class="section attendees-section">
    <h2>Attendees ({{ meeting.attendeeCount || 0 }})</h2>
    <div class="attendee-summary">
      <p>{{ meeting.attendeeCount || 0 }} people are attending this meeting.</p>
      <!-- Note: Individual attendee details would require a separate API call -->
    </div>
  </div>

  <!-- Posts Section -->
  <div class="section posts-section">
    <h2>Discussion</h2>
    <app-post-list [meetingId]="meeting.id || ''"></app-post-list>
  </div>
</div>

<ng-template #loadingTemplate>
  <div class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading meeting details...</p>
  </div>
</ng-template>
